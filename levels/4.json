{
  "hr": [
    {
      "query_id": "hr_l4_1",
      "query": "As an HR strategist, for every department that introduced a new policy in 2023, analyse hiring momentum by: (a) counting staff and managers hired within 90 days after each policy's effective date, (b) computing the staff-to-manager ratio, and (c) recommending which departments must prioritise recruiting managers",
      "expected_response": {
        "department_hiring_insights": [
          {
            "department": "Support",
            "staff_hired": 1,
            "managers_hired": 0,
            "ratio": "∞",
            "recommendation": "Assign a manager – none hired within 90 days of policy launch."
          },
          {
            "department": "Quality Assurance",
            "staff_hired": 0,
            "managers_hired": 1,
            "ratio": 0,
            "recommendation": "Balanced – no immediate action required."
          },
          {
            "department": "Logistics",
            "staff_hired": 1,
            "managers_hired": 0,
            "ratio": "∞",
            "recommendation": "Assign a manager – none hired within 90 days of policy launch."
          },
          {
            "department": "Business Development",
            "staff_hired": 1,
            "managers_hired": 0,
            "ratio": "∞",
            "recommendation": "Assign a manager – none hired within 90 days of policy launch."
          },
          {
            "department": "Strategy",
            "staff_hired": 0,
            "managers_hired": 1,
            "ratio": 0,
            "recommendation": "Balanced – no immediate action required."
          },
          {
            "department": "Compliance",
            "staff_hired": 1,
            "managers_hired": 0,
            "ratio": "∞",
            "recommendation": "Assign a manager – none hired within 90 days of policy launch."
          },
          {
            "department": "Production",
            "staff_hired": 1,
            "managers_hired": 0,
            "ratio": "∞",
            "recommendation": "Assign a manager – none hired within 90 days of policy launch."
          },
          {
            "department": "Innovation",
            "staff_hired": 0,
            "managers_hired": 1,
            "ratio": 0,
            "recommendation": "Balanced – no immediate action required."
          }
        ]
      },
      "explanation": "Requires multi‑hop reasoning across three HR tables: first locate 2023 policies, then join employees by department & join date window, finally derive ratios and narrative recommendations.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "hr_policies",
            "filter": "(effective_date >= '2023-01-01') AND (effective_date <= '2023-12-31')"
          }
        },
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "hr_employees",
            "filter": "(date_joined >= '2023-01-01') AND (date_joined <= '2023-12-31')",
            "related": "hr_departments_by_department_id",
            "fields": ["date_joined", "role"]
          }
        }
      ],
      "sample_solution": "Fetch 2023 HR_POLICIES, for each department pull HR_EMPLOYEES joined via related option, filter to 90‑day window, compute staff/managers counts, derive ratio"
    },
    {
      "query_id": "hr_l4_2",
      "query": "As an HR analyst, evaluate policy effectiveness: For departments with policies effective in 2022, calculate (1) the median days between policy effective date and the first employee hire after that date, (2) classify departments where this lag exceeded 13 days, and (3) propose one onboarding improvement for each slow‑to‑hire department.",
      "expected_response": {
        "lag_analysis": [
          {
            "department": "Sales",
            "median_lag_days": 14,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          },
          {
            "department": "Marketing",
            "median_lag_days": 9,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "Engineering",
            "median_lag_days": 4,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "HR",
            "median_lag_days": 19,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          },
          {
            "department": "Finance",
            "median_lag_days": 14,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          },
          {
            "department": "Operations",
            "median_lag_days": 9,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "Customer Service",
            "median_lag_days": 4,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "IT",
            "median_lag_days": 19,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          },
          {
            "department": "Legal",
            "median_lag_days": 14,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          },
          {
            "department": "Procurement",
            "median_lag_days": 9,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "R&D",
            "median_lag_days": 4,
            "classification": "On-track",
            "recommendation": "—"
          },
          {
            "department": "Administration",
            "median_lag_days": 19,
            "classification": "Delayed",
            "recommendation": "Reduce lag in first hiring after policy"
          }
        ],
        "summary": "6 of 12 departments exceeded the 13-day threshold."
      },
      "explanation": "Combines policy dates with first‑hire timing per department (employees), needs department metadata for naming; involves grouping and median calculation – analytical reasoning beyond simple joins.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "hr_policies",
            "filter": "(effective_date >= '2022-01-01') AND (effective_date <= '2022-12-31')",
            "related": "hr_departments_by_department_id"
          }
        },
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "hr_employees",
            "filter": "(date_joined >= '2022-01-01') AND (date_joined <= '2023-12-31')",
            "fields": ["date_joined", "role", "department_id"]
          }
        }
      ],
      "sample_solution": "Get 2022 HR_POLICIES; for each department look up first post‑policy HR_EMPLOYEES record, compute lag, flag >=14 days, attach recommendation."
    },
    {
      "query_id": "hr_l4_3",
      "query": "As HR leadership, compare retention of 2022 versus 2023 hire cohorts. Using today’s date, compute the average tenure (in days) of employees hired in each year, produce an insight narrative on retention trends, and recommend two concrete initiatives to improve 2023 cohort retention.",
      "expected_response": {
        "retention_analysis": {
          "average_tenure_days_2022": 1150,
          "average_tenure_days_2023": 600,
          "insight": "2022 hires have stayed on average 550 days longer than the 2023 cohort, indicating early churn risk among recent hires.",
          "recommendations": [
            "Implement mentorship programme pairing 2023 hires with 2022 veterans.",
            "Conduct stay‑interviews with 2023 staff to identify pain points."
          ]
        }
      },
      "explanation": "Requires calculating tenure by subtracting date_joined from current date for two distinct cohorts, generating comparative metrics and actionable recommendations – multi‑step reasoning across employees & departments data.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "hr_employees",
            "filter": "(date_joined >= '2022-01-01') AND (date_joined <= '2023-12-31')",
            "fields": "employee_id,first_name,last_name,date_joined"
          }
        }
      ],
      "sample_solution": "Fetch HR_EMPLOYEES for 2022‑23, group by hire year, compute days since join to 2025‑04‑23, compare averages, craft insights and recommendations."
    }
  ],
  "finance": [
    {
      "query_id": "finance_l4_1",
      "query": "As a Finance director, for each product category in fiscal year 2022, calculate total revenue. Rank the categories, highlight the top two for investment focus, and provide two actionable recommendations based on your findings.",
      "expected_response": {
        "category_analysis": [
          {
            "category": "Software",
            "revenue": 10850
          },
          {
            "category": "Electronics",
            "revenue": 10500
          },
          {
            "category": "Hardware",
            "revenue": 9150
          }
        ],
        "top_categories": ["Software", "Electronics"],
        "recommendations": [
          "Increase marketing budget for Software to capitalise on its high margin.",
          "Negotiate supplier costs for Electronics to further improve margin."
        ]
      },
      "explanation": "Requires aggregating revenue data across two finance tables, ranking results, and crafting strategic recommendations.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "finance_revenues",
            "filter": "(revenue_date >= '2022-01-01') AND (revenue_date <= '2022-12-31')",
            "related": "finance_products_by_product_id"
          }
        }
      ],
      "sample_solution": "Fetch FINANCE_REVENUES for 2022 with related parameter for FINANCE_PRODUCTS, then group and sum revenue by category, focusing on Electronics and Software."
    },
    {
      "query_id": "finance_l4_2",
      "query": "As a Finance analyst, evaluate quarterly cash‑flow for 2022: combine total revenues, capital expenses, and operational expenses per quarter, detect any quarters with negative net cash flow, summarise the trend, and propose a corrective action.",
      "expected_response": {
        "quarterly_cash_flow": [
          {
            "quarter": "Q1 2022",
            "total_revenue": 7250,
            "capital_expenses": 0,
            "operational_expenses": 750,
            "net_cash_flow": 6500
          },
          {
            "quarter": "Q2 2022",
            "total_revenue": 7500,
            "capital_expenses": 1200,
            "operational_expenses": 300,
            "net_cash_flow": 6000
          },
          {
            "quarter": "Q3 2022",
            "total_revenue": 7750,
            "capital_expenses": 0,
            "operational_expenses": 1400,
            "net_cash_flow": 6350
          },
          {
            "quarter": "Q4 2022",
            "total_revenue": 8000,
            "capital_expenses": 500,
            "operational_expenses": 750,
            "net_cash_flow": 6750
          }
        ],
        "negative_cash_flow_quarters": [],
        "insight": "Net cash flow remained positive in all quarters.",
        "recommendation": "No immediate action required."
      },
      "explanation": "Integrates revenues and two categories of expenses across quarters, performs arithmetic to derive net cash flow, flags negative periods, and generates strategic guidance.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "finance_revenues",
            "filter": "(year=2022)",
            "fields": ["revenue_amount", "quarter"]
          }
        },
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "finance_expenses",
            "filter": "(expense_date >= '2022-01-01') AND (expense_date <= '2022-12-31')",
            "fields": ["amount", "category", "expense_date"]
          }
        }
      ],
      "sample_solution": "Aggregate 2022 FINANCE_REVENUES by quarter, split FINANCE_EXPENSES into capital/operational per quarter, compute net cash flow, highlight negatives, craft recommendation."
    }
  ],
  "ops": [
    {
      "query_id": "ops_l4_1",
      "query": "As an Operations reliability engineer, build a risk profile for each machine installed in 2021: (a) count maintenance actions, (b) count anomalies, (c) derive a risk tier (High if anomalies ≥2 or maintenance ≥3, Medium if anomalies=1 or maintenance=2, else Low) and (d) recommend one mitigation for High‑risk machines.",
      "expected_response": {
        "machine_risk_profile": [
          [
            {
              "machine_name": "Machine 1",
              "machine_id": 1,
              "status": "Active",
              "installation_date": "2021-01-10",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 2",
              "machine_id": 2,
              "status": "Maintenance",
              "installation_date": "2021-02-15",
              "maintenance_actions": 1,
              "anomalies": 1
            },
            {
              "machine_name": "Machine 3",
              "machine_id": 3,
              "status": "Active",
              "installation_date": "2021-03-20",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 4",
              "machine_id": 4,
              "status": "Inactive",
              "installation_date": "2021-04-25",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 5",
              "machine_id": 5,
              "status": "Active",
              "installation_date": "2021-05-30",
              "maintenance_actions": 1,
              "anomalies": 1
            },
            {
              "machine_name": "Machine 6",
              "machine_id": 6,
              "status": "Maintenance",
              "installation_date": "2021-06-04",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 7",
              "machine_id": 7,
              "status": "Active",
              "installation_date": "2021-07-09",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 8",
              "machine_id": 8,
              "status": "Active",
              "installation_date": "2021-08-14",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 9",
              "machine_id": 9,
              "status": "Inactive",
              "installation_date": "2021-09-19",
              "maintenance_actions": 1,
              "anomalies": 1
            },
            {
              "machine_name": "Machine 10",
              "machine_id": 10,
              "status": "Active",
              "installation_date": "2021-10-24",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 11",
              "machine_id": 11,
              "status": "Maintenance",
              "installation_date": "2021-11-29",
              "maintenance_actions": 1,
              "anomalies": 0
            },
            {
              "machine_name": "Machine 12",
              "machine_id": 12,
              "status": "Active",
              "installation_date": "2021-12-04",
              "maintenance_actions": 1,
              "anomalies": 0
            }
          ]
        ],
        "summary": "All machines are Low risk."
      },
      "explanation": "Combines maintenance logs, anomaly flags and machine metadata – multi‑hop aggregation across two structured sources and unstructured note insights to compute risk tiers and generate recommendations.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "ops_machines",
            "filter": "(installation_date >= '2021-01-01') AND (installation_date <= '2021-12-31')",
            "related": "ops_maintenance_by_machine_id"
          }
        }
      ],
      "sample_solution": "Fetch OPS_MACHINES with installation dates and related maintenance, aggregate actions and anomalies per machine, compute risk tier logic, add recommendation for High."
    },
    {
      "query_id": "ops_l4_2",
      "query": "As an Operations manager, analyse maintenance effectiveness by location. For every location: compute active machine count and their anomaly rate.",
      "expected_response": {
        "location_maintenance_analysis": [
          {
            "New York": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Chicago": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Phoenix": {
              "active_machines": 1,
              "anomalies": 1,
              "anomaly_rate": 1.0
            },
            "San Antonio": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "San Diego": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "San Jose": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Jacksonville": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Fort Worth": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Charlotte": {
              "active_machines": 1,
              "anomalies": 1,
              "anomaly_rate": 1.0
            },
            "Indianapolis": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Seattle": {
              "active_machines": 1,
              "anomalies": 0,
              "anomaly_rate": 0.0
            },
            "Washington": {
              "active_machines": 1,
              "anomalies": 1,
              "anomaly_rate": 1.0
            }
          }
        ]
      },
      "explanation": "Requires grouping machines by location, joining maintenance records, computing active machine counts and anomaly rates.",
      "tools_needed": ["get_table_records"],
      "expected_tool_calls": [
        {
          "tool": "get_table_records",
          "params": {
            "table_name": "ops_machines",
            "filter": "(status = 'Active')",
            "fields": ["machine_id", "location", "installation_date"],
            "related": "ops_maintenance_by_machine_id"
          }
        }
      ],
      "sample_solution": "Fetch OPS_MACHINES with active machines and related maintenance, aggregate actions per location, compute anomaly rates."
    }
  ]
}
